# Telegram Quiz Bot

Элементарный простейший чат-бот для проведения квизов в Telegram.

## Структура проекта

```
Project12/
├── app/                          # Основной пакет приложения
│   ├── __init__.py              # Инициализация пакета
│   ├── main.py                  # Точка входа приложения
│   ├── bot.py                   # Инициализация бота и диспетчера
│   ├── config.py                # Конфигурация (переменные окружения)
│   ├── logic.py                 # Логика квиза и данные вопросов
│   ├── db/                      # Модуль работы с базой данных
│   │   ├── __init__.py
│   │   ├── core.py              # Инициализация БД и создание таблиц
│   │   └── quiz.py              # Функции для работы с состоянием квиза
│   └── handlers/                # Обработчики сообщений и команд
│       ├── __init__.py
│       ├── start.py             # Обработчик команды /start
│       └── quiz.py              # Обработчики квиза и ответов
├── local.env                     # Файл с переменными окружения
├── pyproject.toml               # Конфигурация проекта
├── old_project.py               # Исходный монолитный файл (для справки)
└── README.md                    # Этот файл
```

## Описание модулей

### `app/main.py`
Точка входа приложения. Инициализирует базу данных, создает бота и диспетчер, регистрирует обработчики и запускает поллинг.

### `app/bot.py`
Модуль для создания экземпляров бота и диспетчера aiogram.

### `app/config.py`
Модуль конфигурации. Читает переменные окружения:
- `API_TOKEN` - токен Telegram бота
- `DATABASE_URL` - URL базы данных (по умолчанию SQLite)
- `LOG_LEVEL` - уровень логирования

### `app/logic.py`
Содержит:
- `quiz_data` - список вопросов квиза с вариантами ответов
- `new_quiz()` - функция для запуска/продолжения квиза

### `app/db/core.py`
Инициализация базы данных:
- Создание директории для БД (если не существует)
- Создание таблицы `quiz_state` для хранения состояния квиза пользователей

### `app/db/quiz.py`
Функции для работы с состоянием квиза:
- `update_quiz_index()` - обновление индекса текущего вопроса для пользователя
- `get_quiz_index()` - получение индекса текущего вопроса пользователя

### `app/handlers/start.py`
Обработчик команды `/start`:
- Приветственное сообщение
- Кнопка "Начать игру" в Reply-клавиатуре

### `app/handlers/quiz.py`
Обработчики квиза:
- Команда `/quiz` и кнопка "Начать игру" - запуск квиза
- Callback-обработчик ответов на вопросы квиза
- Проверка правильности ответов и переход к следующему вопросу

## Установка и запуск

1. Установите зависимости:
```bash
pip install aiogram aiosqlite python-dotenv
```

2. Настройте переменные окружения в файле `local.env`:
```
API_TOKEN=ваш_токен_бота
DATABASE_URL=sqlite:///./db/quiz_bot.db
LOG_LEVEL=INFO
```

3. Запустите бота:
```bash
python -m app.main
```

Или из корня проекта:
```bash
cd Project12
python -m app.main
```

## Функционал

- Команда `/start` - приветствие и кнопка для начала игры
- Команда `/quiz` или кнопка "Начать игру" - запуск квиза
- Интерактивные вопросы с вариантами ответов (инлайн-кнопки)
- Проверка правильности ответов
- Сохранение состояния квиза в базе данных SQLite
- Автоматический переход к следующему вопросу

## База данных

Используется SQLite для хранения состояния квиза каждого пользователя. База данных создается автоматически при первом запуске в директории `db/`.

Таблица `quiz_state`:
- `user_id` (INTEGER PRIMARY KEY) - ID пользователя Telegram
- `question_index` (INTEGER) - индекс текущего вопроса в квизе

## Примечания

- Проект создан на основе монолитного файла `old_project.py`
- Структура организована по принципам модульности и разделения ответственности
- Тесты и дополнительные универсальные коннекторы не реализованы (как и требовалось)

